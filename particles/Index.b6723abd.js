var L=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var T=(s,e,t)=>e in s?L(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,g=(s,e)=>{for(var t in e||(e={}))K.call(e,t)&&T(s,t,e[t]);if(q)for(var t of q(e))z.call(e,t)&&T(s,t,e[t]);return s},C=(s,e)=>P(s,R(e));import{o as i,c as h,_ as O,a,b as n,i as d,t as _,F as u,j as f,d as E,w as y,u as S,q as j,n as D,g as F,m as V,f as N,k as b,e as p,h as B,s as M}from"./index_prod.c6cf9509.js";import{_ as w}from"./Input.5e505603.js";import{i as H,a as I,v as k}from"./ComponentResolver.1bd17796.js";import{_ as v}from"./Value.0be1267b.js";const G={props:{fields:{type:Array,required:!0}},data(){return{item:{}}},created(){let s={};for(let e in this.fields){let t=this.fields[e];s[t]=this.__("fields->"+t)+" \u2191",s["-"+t]=this.__("fields->"+t)+" \u2193"}this.item={label:this.__("\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0430"),name:"sort",value:this.$route.query.sort,type:H.select,options:{items:s,withPrompt:!0},size:I.sm}}},J=Object.assign(G,{name:"Sort",setup(s){return(e,t)=>(i(),h(w,{item:e.item},null,8,["item"]))}}),Q={data(){return{item:{label:this.__("\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C"),name:"show[deleted]",value:this.$route.query["show[deleted]"],type:H.select,options:{items:{"":this.__("\u0422\u043E\u043B\u044C\u043A\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435"),"only-deleted":this.__("\u0422\u043E\u043B\u044C\u043A\u043E \u0443\u0434\u0430\u043B\u0451\u043D\u043D\u044B\u0435"),"with-deleted":this.__("\u0412\u0441\u0435")}},size:I.sm}}}},U=Object.assign(Q,{name:"SoftDelete",setup(s){return(e,t)=>(i(),h(w,{item:e.item},null,8,["item"]))}}),W={props:{type:{type:String,required:!0},id:{}},data(){return{config:this.booted.components.current.config}},methods:{toggleHead(s){let e=$(s.target).prop("checked");$(".crud-index-data tbody .selection").prop("checked",e),this.toggleBody()},toggleBody(){let s=$(".crud-index-data tbody .selection").length,e=$(".crud-index-data tbody .selection:checked").length;$(".crud-index-data thead .selection").prop("checked",e===s),e>0?$(".crud-index-data .actions").fadeIn(100):$(".crud-index-data .actions").fadeOut(100)},deleteAllAction(){this.sendRequest({method:"POST",path:this.config.http.path+"/destroy-all?_method=DELETE"},s=>{for(let e in this.$parent.$data.items){let t=this.$parent.$data.items[e];s.includes(t.id.value)&&(t.is_deleted=!0)}})},restoreAllAction(){this.sendRequest({method:"POST",path:this.config.http.path+"/restore-all?_method=DELETE"},s=>{for(let e in this.$parent.$data.items){let t=this.$parent.$data.items[e];s.includes(t.id.value)&&(t.is_deleted=!1)}})},sendRequest(s,e){let t=new FormData,l=Array.from(document.querySelectorAll(".crud-index-data tbody .selection:checked"),o=>parseInt(o.value));for(let o in l)t.append("selection[]",l[o]);confirm(this.__("\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?"))&&this.booted.helpers.http.send(this,g({body:t},s)).then(o=>{o.statusType==="success"&&(e(l),$(".crud-index-data .selection").prop("checked",!1),this.toggleBody())})}}},X={key:0,style:{width:"50px"}},Y={key:1},Z=["value"],x={key:2,class:"actions card card-light",style:{display:"none"}},ee={class:"card-header"},te={class:"card-body"},se=n("i",{class:"fas fa-trash-alt mr-1"},null,-1),ie=n("i",{class:"fas fa-trash-restore mr-1"},null,-1);function le(s,e,t,l,o,r){return o.config.selectionActions.length>0?(i(),a(u,{key:0},[t.type==="tableHead"?(i(),a("th",X,[n("input",{type:"checkbox",class:"selection",onChange:e[0]||(e[0]=(...c)=>r.toggleHead&&r.toggleHead(...c))},null,32)])):d("",!0),t.type==="tableBody"?(i(),a("th",Y,[n("input",{type:"checkbox",value:t.id,class:"selection",onChange:e[1]||(e[1]=(...c)=>r.toggleBody&&r.toggleBody(...c))},null,40,Z)])):d("",!0),t.type==="actions"&&(o.config.selectionActions.includes("deleteAll")||o.config.selectionActions.includes("restoreAll"))?(i(),a("div",x,[n("div",ee,_(s.__("\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F")),1),n("div",te,[(i(!0),a(u,null,f(o.config.selectionActions,c=>(i(),a(u,null,[c==="deleteAll"&&!s.$route.query["show[deleted]"]?(i(),a("button",{key:0,class:"btn btn-danger btn-block text-left",onClick:e[2]||(e[2]=(...m)=>r.deleteAllAction&&r.deleteAllAction(...m))},[se,E(" "+_(s.__("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u0441\u0435")),1)])):d("",!0),c==="restoreAll"&&s.$route.query["show[deleted]"]==="only-deleted"?(i(),a("button",{key:1,class:"btn btn-success btn-block text-left",onClick:e[3]||(e[3]=(...m)=>r.restoreAllAction&&r.restoreAllAction(...m))},[ie,E(" "+_(s.__("\u0412\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0432\u0441\u0435")),1)])):d("",!0)],64))),256))])])):d("",!0)],64)):d("",!0)}var A=O(W,[["render",le]]);const ae={class:"btn-group"},ne=n("i",{class:"fas fa-eye"},null,-1),oe=n("i",{class:"fas fa-edit"},null,-1),re=["title"],de=n("i",{class:"fas fa-trash-alt"},null,-1),ce=[de],ue=["set"],he=["title"],_e=n("i",{class:"fas fa-trash-restore"},null,-1),pe=[_e],fe={props:{item:{type:Object,required:!0}},data(){return{config:this.booted.components.current.config}},methods:{deleteAction(){confirm(this.__("\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?"))&&this.booted.helpers.http.send(this,{method:"DELETE",path:this.config.http.path+"/"+this.item.id.value}).then(s=>{s.statusType==="success"&&(this.item.is_deleted=!0)})},restoreAction(){confirm(this.__("\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?"))&&this.booted.helpers.http.send(this,{method:"DELETE",path:this.config.http.path+"/"+this.item.id.value+"/restore"}).then(s=>{s.statusType==="success"&&(this.item.is_deleted=!1)})}}},me=Object.assign(fe,{name:"Actions",setup(s){return(e,t)=>(i(),a("div",ae,[(i(!0),a(u,null,f(e.config.actions,l=>(i(),a(u,null,[s.item.is_deleted?(i(),a(u,{key:1},[l==="restore"?(i(),a("a",{key:0,title:e.__("\u0412\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C"),onClick:t[1]||(t[1]=(...o)=>e.restoreAction&&e.restoreAction(...o)),class:"btn btn-success"},pe,8,he)):d("",!0)],64)):(i(),a(u,{key:0},[l==="show"?(i(),h(S(j),{key:0,title:e.__("\u041F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C"),to:e.$route.path+"/"+s.item.id.value+"/show",class:"btn btn-primary"},{default:y(()=>[ne]),_:1},8,["title","to"])):l==="update"?(i(),h(S(j),{key:1,title:e.__("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"),to:e.$route.path+"/"+s.item.id.value+"/update",class:"btn btn-warning"},{default:y(()=>[oe]),_:1},8,["title","to"])):l==="delete"?(i(),a("a",{key:2,title:e.__("\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),onClick:t[0]||(t[0]=(...o)=>e.deleteAction&&e.deleteAction(...o)),class:"btn btn-danger"},ce,8,re)):d("",!0),e.config.extraActions[l]?(i(),a("div",{key:3,set:e.ea=e.config.extraActions[l](s.item)},[e.ea?(i(),h(N,V({key:0,to:e.ea.path},e.ea.linkAttributes),{default:y(()=>[n("i",D(F(e.ea.iconAttributes)),null,16)]),_:1},16,["to"])):d("",!0)],8,ue)):d("",!0)],64))],64))),256))]))}}),ge={props:{meta:{type:Object,required:!0}},data(){return{items:this.meta.links.slice(1,this.meta.links.length-1)}},methods:{go(s){this.$router.push({path:this.$route.path,query:C(g({},this.$route.query),{page:s})}).then(()=>{this.$parent.$parent.$data.dataKey++})}}},ye={class:"d-flex align-items-center justify-content-between"},be={class:"dataTables_info",id:"example2_info",role:"status","aria-live":"polite"},$e={key:0,class:"pagination m-0"},ke=n("i",{class:"fas fa-angle-left"},null,-1),ve=[ke],Ae=["onClick","innerHTML"],we=n("i",{class:"fas fa-angle-right"},null,-1),qe=[we];function Te(s,e,t,l,o,r){return i(),a("div",ye,[n("div",be,_(s.__("\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E \u0441 :from \u043F\u043E :to \u0437\u0430\u043F\u0438\u0441\u0438 \u0438\u0437 :total",t.meta)),1),o.items.length>1?(i(),a("ul",$e,[n("li",{class:b("page-item "+(t.meta.current_page===1?"disabled":""))},[n("a",{onClick:e[0]||(e[0]=c=>r.go(t.meta.current_page-1)),href:"#",class:"page-link"},ve)],2),(i(!0),a(u,null,f(o.items,c=>(i(),a("li",{class:b("page-item "+(c.active?"active":""))},[n("a",{onClick:m=>r.go(c.label),href:"#",class:"page-link",innerHTML:c.label},null,8,Ae)],2))),256)),n("li",{class:b("page-item "+(t.meta.current_page===t.meta.last_page?"disabled":""))},[n("a",{onClick:e[1]||(e[1]=c=>r.go(t.meta.current_page+1)),href:"#",class:"page-link"},qe)],2)])):d("",!0)])}var Ce=O(ge,[["render",Te]]);const Ee={class:"card card-primary crud-index-data"},Se={class:"card-header"},je={class:"card-title"},Be={class:"card-body"},Oe={class:"table-responsive"},De={class:"table table-hover table-bordered"},Fe={key:0},He={key:0},Ie={key:0,style:{width:"130px"}},Le=["set"],Pe={key:2},Re={key:0,class:"text-right",style:{width:"50px"}},Ke={key:1,class:"m-0"},ze={class:"card-footer"},Ve={data(){return{config:this.booted.components.current.config,model:this.booted.components.current.config.model,fields:{},items:[],meta:{}}},created(){var s;this.booted.helpers.http.send(this,{method:"GET",path:this.config.http.path,query:g(g({},(s=this.config.http.query)!=null?s:{}),this.$route.query)}).then(e=>{if(e.statusType==="success"){this.fields=this.model.prepareFields(this,this.model.list);for(let t in e.data.data)this.items[t]=this.model.prepareValues(this,this.model.list,e.data.data[t]),this.items[t].is_deleted=e.data.data[t].is_deleted;this.meta=e.data.meta}})}},Ne=Object.assign(Ve,{name:"Grid",setup(s){return(e,t)=>(i(),a("div",Ee,[n("div",Se,[n("h3",je,_(e.__("\u0414\u0430\u043D\u043D\u044B\u0435")),1)]),n("div",Be,[e.items.length>0?(i(),a(u,{key:0},[n("div",Oe,[n("table",De,[n("thead",null,[n("tr",null,[p(A,{type:"tableHead"}),(i(!0),a(u,null,f(e.fields,(l,o)=>(i(),a(u,null,[e.config.gridHiddenFields.includes(o)?d("",!0):(i(),a("th",Fe,_(l.label),1))],64))),256)),e.config.actions.length>0?(i(),a("th",He)):d("",!0)])]),n("tbody",null,[(i(!0),a(u,null,f(e.items,l=>(i(),a("tr",D(F(e.config.gridRowAttributes(l))),[p(A,{type:"tableBody",id:l.id.value},null,8,["id"]),(i(!0),a(u,null,f(e.fields,(o,r)=>(i(),a(u,null,[e.config.gridHiddenFields.includes(r)?d("",!0):(i(),a(u,{key:0},[l[r].type===k.image?(i(),a("td",Ie,[p(v,{item:l[r],id:l.id.value},null,8,["item","id"])])):l[r].type===k.httpSelect||l[r].type===k.httpSwitcher?(i(),a("td",{key:1,set:l[r].attributes.disabled=l.is_deleted===!0},[p(v,{item:l[r],id:l.id.value},null,8,["item","id"])],8,Le)):(i(),a("td",Pe,[p(v,{item:l[r],id:l.id.value},null,8,["item","id"])]))],64))],64))),256)),e.config.actions.length>0?(i(),a("td",Re,[p(me,{item:l},null,8,["item"])])):d("",!0)],16))),256))])])]),p(A,{type:"actions"})],64)):(i(),a("h5",Ke,_(e.__("\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445")),1))]),n("div",ze,[e.items.length>0?(i(),h(Ce,{key:0,meta:e.meta},null,8,["meta"])):d("",!0)])]))}}),Me={key:0,class:"card card-primary mb-3"},Ge=["data-target"],Je={class:"card-title w-100"},Qe=n("i",{class:"fas fa-angle-down"},null,-1),Ue=["id"],We={class:"card-body"},Xe={class:"row"},Ye={class:"card-footer text-right"},Ze={class:"btn-group"},xe={type:"reset",class:"btn btn-danger"},et={type:"submit",class:"btn btn-primary"},tt={data(){return{config:this.booted.components.current.config,model:this.booted.components.current.config.model,filterId:"el-"+this.booted.helpers.string.uniqueId(),items:{},dataKey:0}},created(){var l;let s=this.config.http;s.path=s.path.replace(":id",this.$route.params.id).replace(":slug",this.$route.params.slug),this.config.http.path=s.path,this.booted.components.current.page.init();let e=this.$route.query,t={};e=Object.fromEntries(Object.entries(e).filter(([o,r])=>o.includes("filter[")));for(let o in e)if(o=o.replace("filter[","",o),o.includes("][")){let r=o.split("]["),c=r[0],m=r[1].replace("]","");(l=t[c])!=null||(t[c]={}),t[c][m]=e["filter["+o]}else t[o.replace("]","")]=e["filter["+o];this.items=this.model.prepareFilters(this,this.model.filters,t)},methods:{submit(s){let e=new FormData(s.target),t={},l=0;e.forEach((o,r)=>{r.includes("[]")&&(r=r.replace("[]","["+l+"]"),l++),t[r]=o}),this.$router.push({path:this.$route.path,query:M.exports.pickBy(t)}).then(()=>{this.dataKey++})},reset(s){this.$router.push({path:this.$route.path}).then(()=>{$(s.target).find("input, textarea, select").val("").trigger("change"),this.dataKey++})}}},ot=Object.assign(tt,{name:"Index",setup(s){return(e,t)=>(i(),a(u,null,[e.config.showFilter?(i(),a("div",Me,[n("div",{class:"card-header d-flex align-items-center justify-content-between",role:"button","data-toggle":"collapse","data-target":"#"+e.filterId},[n("h3",Je,_(e.__("\u0424\u0438\u043B\u044C\u0442\u0440")),1),Qe],8,Ge),n("div",{id:e.filterId,class:"collapse show"},[n("form",{onSubmit:t[0]||(t[0]=B((...l)=>e.submit&&e.submit(...l),["prevent"])),onReset:t[1]||(t[1]=B((...l)=>e.reset&&e.reset(...l),["prevent"]))},[n("div",We,[n("div",Xe,[(i(!0),a(u,null,f(e.items,(l,o)=>(i(),h(w,{item:l},null,8,["item"]))),256)),e.model.sortings.length>0?(i(),h(J,{key:0,fields:e.model.sortings},null,8,["fields"])):d("",!0),e.config.hasSoftDelete?(i(),h(U,{key:1})):d("",!0)])]),n("div",Ye,[n("div",Ze,[n("button",xe,_(e.__("\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C")),1),n("button",et,_(e.__("\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C")),1)])])],32)],8,Ue)])):d("",!0),(i(),h(Ne,{key:e.dataKey}))],64))}});export{ot as _};
